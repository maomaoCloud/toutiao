<html xmlns:th="http://www.thymeleaf.org">
<script th:inline="javascript">
    /* <![CDATA[ */
    $(function () {
        //chosen select input
        $(".chosen-select").chosen({disable_search_threshold: 10});

        $("#updateMatchRule").click(function(){
            $.post("/sys/matchSetting/save",$("#matchRuleForm").serialize(),function (data) {
                //resetMatchRule();
            });
        });
        $("#resettingMatchRule").click(function () {
            resetMatchRule();
        });
        //首轮座位规则回显
        var ruleSeat = $("#ruleSeat").attr("value");
        $("#ruleSeat").find("option").each(function(){
            if ($(this).val()==ruleSeat){
                $("#ruleSeat_chosen").find("span").html($(this).html());
            }
        });

        $("#next-step").click(function () {
            //do something

            //var matchId = $("#nowMatchSetting").val();
            var matchId ="JJX390iH";
            updateMatchId(matchId);
            //去签到页面
            $("#signSetting").click();
            showNav();
        });
    })

    function resetMatchRule() {
        //重置基础规则设置
        $("#matchRule").load("/sys/matchSetting/matchRule?token="+$("#ruleToken").val()+"&matchId="+$("#nowSettingMatch").val(),function(){});
    }

    function showDraw(obj) {
        var isShow = $(obj).val();
        if (isShow == 1) {
            $("#drawShow").show();
        } else {
            $("#drawShow").hide();
            $("#ruleDraw").val("1");
        }
    }
    /* ]]> */
</script>
<section class="tile color transparent-black">
    <!-- tile header -->
    <div class="tile-header">
        <h1><strong>基础规则设置</strong></h1>
        <div class="controls">
            <a href="#" class="refresh"><i class="fa fa-refresh"></i></a>
            <a href="#" class="remove"><i class="fa fa-times"></i></a>
        </div>
    </div>
    <!-- /tile header -->
    <!-- tile body -->
    <div class="tile-body">

        <form class="form-horizontal" role="form" id="matchRuleForm">

            <div class="form-group">
                <label class="col-sm-4 control-label">总轮次</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" name="ruleTurn" th:value="${matchRule}==null?'':${matchRule.ruleTurn}">
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-4 control-label">每轮副数</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" name="rulePair" th:value="${matchRule}==null?'':${matchRule.rulePair}">
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-4 control-label">每轮时间</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" name="ruleTime" th:value="${matchRule}==null?'':${matchRule.ruleTime}">
                </div>
            </div>

            <div class="form-group" th:if="${matchRule.ruleDraw!=1}">
                <label class="col-sm-4 control-label">是否显示平局</label>
                <div class="col-sm-8" id="isShowDraw">
                    <div class="radio radio-transparent">
                        <input type="radio" id="optionsRadios2" value="0" name="checkRuleDraw"
                               onchange="showDraw(this);">
                        <label for="optionsRadios2" style="float: left;">否</label>
                    </div>
                    <div class="radio radio-transparent">
                        <input type="radio" id="optionsRadios1" value="1" name="checkRuleDraw" checked
                               onchange="showDraw(this);">
                        <label for="optionsRadios1" style="float: left;">是</label>
                    </div>
                </div>
            </div>

            <div class="form-group" th:if="${matchRule.ruleDraw==1}">
                <label class="col-sm-4 control-label">是否显示平局</label>
                <div class="col-sm-8" >
                    <div class="radio radio-transparent">
                        <input type="radio" id="optionsRadios2" value="0" name="checkRuleDraw" checked
                               onchange="showDraw(this);">
                        <label for="optionsRadios2" style="float: left;">否</label>
                    </div>
                    <div class="radio radio-transparent">
                        <input type="radio" id="optionsRadios1" value="1" name="checkRuleDraw"
                               onchange="showDraw(this);">
                        <label for="optionsRadios1" style="float: left;">是</label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-4 control-label">积分设置</label>
                <div class="col-sm-8">
                    <div class="row">
                        <div class="form-group col-sm-6" style="margin-left: 0px">
                            <label>胜</label>
                            <input type="text" class="form-control" name="ruleWin" th:value="${matchRule}==null?'':${matchRule.ruleWin}">
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-6" style="margin-left: 0px">
                            <label>负</label>
                            <input type="text" class="form-control" name="ruleFail" th:value="${matchRule}==null?'':${matchRule.ruleFail}">
                        </div>
                    </div>
                    <div class="row" id="drawShow" th:if="${matchRule.ruleDraw!=1}">
                        <div class="form-group col-sm-6" style="margin-left: 0px">
                            <label>平</label>
                            <input type="text" class="form-control" id="ruleDraw" name="ruleDraw" th:value="${matchRule}==null?'':${matchRule.ruleDraw}">
                        </div>
                    </div>
                    <div class="row" id="drawShow" style="display: none" th:if="${matchRule.ruleDraw==1}">
                        <div class="form-group col-sm-6" style="margin-left: 0px">
                            <label>平</label>
                            <input type="text" class="form-control" id="ruleDraw" name="ruleDraw" th:value="${matchRule}==null?'':${matchRule.ruleDraw}">
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-4 control-label">首轮座位排序方式</label>
                <div class="col-sm-8">
                    <select class="chosen-select chosen-transparent form-control" id="ruleSeat" th:name="ruleSeat" th:value="${matchRule}==null?'':${matchRule.ruleSeat}">
                        <option th:value="0">请选择首轮编排方式</option>
                        <option th:value="1"> 临近编排</option>
                        <option th:value="2"> 首尾编排</option>
                        <option th:value="3"> 拦腰编排</option>
                    </select>
                </div>
            </div>

            <div class="form-group form-footer" style="margin-bottom: -28px;margin-top: 49px">
                <div class="col-sm-offset-4 col-sm-8" style="margin-left: 12.333333%;">
                    <input type="hidden" th:name="token" th:value="${token}" id="ruleToken">
                    <input type="hidden" th:name="id" th:value="${matchRule}==null?'':${matchRule.id}">
                    <button type="button" class="btn btn-primary" id="updateMatchRule">保存</button>
                    <button type="button" class="btn btn-default" id="resettingMatchRule">重置</button>
                </div>
            </div>
        </form>
    </div>
    <!-- /tile body -->
</section>

<div class="next-btn-box" style="text-align: center">
    <button type="button" id="next-step" style="font-size: 18px; padding: 10px 20px;"
            class="btn btn-green margin-bottom-20">设置完成，下一步
    </button>
</div>