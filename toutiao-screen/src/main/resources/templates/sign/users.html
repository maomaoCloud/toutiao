<html xmlns:th="http://www.thymeleaf.org">

<style>
    body {
        width: 100%;
        font-family: PingFangSC-Regular, Helvetica, Arial, Microsoft Yahei, sans-serif !important;
    }

    .full-screen {
        padding-left: 15px !important;
    }

    .body_full {
        position: absolute !important;
        top: 0;
    }

    .box-title {
        text-align: center;
        width: 100%;
        font-weight: 500;
        font-size: 18px !important;
        font-family: PingFangSC-Regular, Helvetica, Arial, Microsoft Yahei, sans-serif !important;
        border-bottom: 1px solid rgba(200, 200, 200, .2);
        padding-bottom: 10px !important;
    }

    .tile-body {
        width: 100%;
        text-align: center;
    }

    #user-table {
        color: #FFF;
    }

    #user-table .head {
        width: 60px;
        height: 60px;
        border-radius: 50%;
    }

    #user-table th {
        text-align: center;
    }

    #user-table td {
        vertical-align: middle;
        text-align: center;
    }

    .line-right {
        border-right: 1px solid #e8e8e8;
    }

    .edit-groupName {
        border: none;
        border-bottom: 1px solid #FFF;
        color: #FFF;
        outline: none;
        background-color: transparent;
        width: 150px;
    }
</style>

<!-- col 12 -->
<div class="col-lg-12 col-md-12">


    <!-- tile -->
    <section class="tile color transparent-black">


        <!-- tile header -->
        <div class="tile-header" style="text-align:center;">
            <h1><strong>参赛人员</strong></h1>
            <div style="overflow:hidden;margin-bottom:-10px;min-height:44px;">
                <a style="margin-top: 8px;" href="javascript:;" class="fileType">
                    选择文件<input type="file" id="uploadFile" name="uploadFile" onchange="checkSuffix(event);"/>
                </a>
                <span style="vertical-align: text-bottom;" id="fileName"></span>
                <input type="button" onclick="fileUpload()">
            </div>
        </div>
        <!-- /tile header -->

        <!-- tile body -->
        <div class="tile-body nopadding">

            <table class="table" id="user-table">
                <thead>
                <tr style="border-top: 1px solid rgba(100,100,100,0.6);">
                    <th class="line-right" style="vertical-align: middle;" rowspan="2">团队名</th>
                    <th colspan="5" style="border-bottom: none" class="line-right">用户信息</th>
                    <th colspan="5" style="border-bottom: none" class="line-right">搭档信息</th>
                    <th rowspan="2" style="vertical-align: middle;">报名时间</th>
                </tr>
                <tr>
                    <th></th>
                    <th>姓名</th>
                    <th>手机</th>
                    <th>身份证号</th>
                    <th class="line-right">状态</th>
                    <th></th>
                    <th>姓名</th>
                    <th>手机</th>
                    <th>身份证号</th>
                    <th class="line-right">状态</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user,userStat : ${datas}">
                    <td class="line-right">
                        <input class="edit-groupName" th:data-id="${user.orderId}" th:value="${user.groupName}">
                    </td>
                    <td>
                        <img class="head" th:src="${user.head}" src="assets/images/peter-avatar.jpg">
                    </td>
                    <td th:text="${user.name}"></td>
                    <td th:text="${user.phone}">18012673347</td>
                    <td th:text="${user.idCard}">18012673347</td>
                    <td class="line-right" th:text="${user.signStatue}"></td>
                    <td>
                        <img th:if="${user.hasPartner}" class="head" th:src="${user.partnerHead}"
                             src="assets/images/peter-avatar.jpg">
                    </td>
                    <td th:text="${user.partnerName}"></td>
                    <td th:text="${user.partnerPhone}">18012673347</td>
                    <td th:text="${user.partnerIdCard}">18012673347</td>
                    <td class="line-right" th:text="${user.partnerSignStatue}"></td>
                    <td th:text="${user.applyDate}">2018-10-10 12:23:56</td>
                </tr>
                </tbody>
            </table>

        </div>
        <!-- /tile body -->


    </section>
    <!-- /tile -->

</div>
<!-- /col 12 -->

<script th:inline="javascript">
    /* <![CDATA[ */
    $(function () {
        $(".edit-groupName").blur(function () {
            var val = $(this).val();
            var orderId = $(this).attr("data-id");
            $.post("/sys/sign/userInfo/groupName/save", {groupName: val, orderId: orderId}, function (res) {

            });
        });

    })
    /* ]]> */

    function fileUpload(){
        var formData = new FormData();
        formData.append("file",document.getElementById("uploadFile").files[0]);
        var timer;
        //用 formData来ajax提交文件
        $.ajax({
            url: "/sys/sign/importUser",
            data: formData,
            type: "post",
            dataType: "json",
            cache: false,//上传文件无需缓存
            processData: false,//用于对data参数进行序列化处理 这里必须false
            contentType: false, //必须
            beforeSend:function(){
                /*$('#uploadBtn').attr("disabled","disabled");
                $("#uploadBtn").css({'background-color':'#dcdcdc'});
                $('#progressBarMask').show();
                //启动定时，查询进度
                timer = setInterval(getProcess,500);*/
            },
            success: function (data) {
                //上传完成，清除定时任务
                if (timer != undefined && timer != null){
                    clearInterval(timer);
                }
                $('#progressBarMask').hide();
                if (data.status == 200){
                    $.post("${path}/superOrder/getOrderCountSession.do",{},function(data){
                        if (data.status == 200){
                            clearProcess();
                            dialogAlert("提示","操作成功，修改"+data.data+"条，总共"+orderNum+"条",function(){
                                window.location.href="./superOrderUpdateList.do";
                            });
                        } else {
                            clearProcess();
                        }
                    },"json");
                } else if (data.status == 500){
                    dialogAlert("提示",data.data,function(){
                    });
                    clearProcess();
                }
            },
            error:function(data){
                dialogAlert("提示","操作失败",function(){
                });
                //清除定时任务
                if (timer != undefined && timer != null){
                    clearInterval(timer);
                }
                $('#progressBarMask').hide();
                clearProcess();
            }
        });
    }
</script>



